<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Further Pure 3</title>
<link rel="stylesheet" href="https://stackedit.io/res-min/themes/base.css" />
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body><div class="container"><h1 id="series-and-limits">Series and limits</h1>



<h2 id="limits">Limits</h2>

<p>If <script type="math/tex" id="MathJax-Element-1">x</script> is a real number, which varies such that it approaches a particular value <script type="math/tex" id="MathJax-Element-2">a</script>, but is never equal to <script type="math/tex" id="MathJax-Element-3">a</script>, this is signified by writing <script type="math/tex" id="MathJax-Element-4">x \to a</script>. <br>
The variation of <script type="math/tex" id="MathJax-Element-5">x</script> must be such that for any positive number, <script type="math/tex" id="MathJax-Element-6">\delta</script>, <script type="math/tex" id="MathJax-Element-7">x</script> can be chosen so that <script type="math/tex" id="MathJax-Element-8">0 < |x-a| < \delta</script>, no matter how small <script type="math/tex" id="MathJax-Element-9">\delta</script> may be.</p>

<p>When a function <script type="math/tex" id="MathJax-Element-10">f(x)</script> is such that <script type="math/tex" id="MathJax-Element-11">f(x) \to l</script> when <script type="math/tex" id="MathJax-Element-12">x \to a</script>, where <script type="math/tex" id="MathJax-Element-13">l</script> is finite, the number <script type="math/tex" id="MathJax-Element-14">l</script> is called the limit or limiting value of <script type="math/tex" id="MathJax-Element-15">f(x)</script> as <script type="math/tex" id="MathJax-Element-16">x \to a</script>.</p>

<p>This is expressed as <script type="math/tex; mode=display" id="MathJax-Element-17">\lim_{x \to a} f(x) = l</script></p>

<p>The statements <script type="math/tex" id="MathJax-Element-18">x \to \infty</script> and <script type="math/tex" id="MathJax-Element-19">f(x) \to \infty</script> mean that the values of <script type="math/tex" id="MathJax-Element-20">x</script> and <script type="math/tex" id="MathJax-Element-21">f(x)</script> increase indefinitely. However, it should never be written that <script type="math/tex" id="MathJax-Element-22">x = \infty</script> as <script type="math/tex" id="MathJax-Element-23">\infty</script> is not a number.</p>



<h3 id="direction-of-approach">Direction of approach</h3>

<p>Unless stated otherwise, <script type="math/tex" id="MathJax-Element-24">x \to a</script> means that <script type="math/tex" id="MathJax-Element-25">x</script> can approach <script type="math/tex" id="MathJax-Element-26">a</script> from either direction on the real axis.</p>

<p>The notation <script type="math/tex" id="MathJax-Element-27">x \to a+</script> is used to signify that <script type="math/tex" id="MathJax-Element-28">a</script> approaches from the right, while <script type="math/tex" id="MathJax-Element-29">x \to a-</script> is used to signify an approach from the left.</p>

<p>This distinction can be important. <br>
consider the behaviour of <script type="math/tex" id="MathJax-Element-30">\frac 1 x</script> as <script type="math/tex" id="MathJax-Element-31">x \to 0</script>. When <script type="math/tex" id="MathJax-Element-32">x \to 0+, \frac 1 x \to \infty</script>, but when <script type="math/tex" id="MathJax-Element-33">x \to 0-, \frac 1 x \to -\infty</script>.</p>



<h3 id="finding-simple-limits">Finding simple limits</h3>

<p>Some cases are simple</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-34">\lim_{x \to 0} \frac{1+x}{2-x} = \frac 1 2 </script> <br>
because <script type="math/tex" id="MathJax-Element-35">1+x \to 1</script> and <script type="math/tex" id="MathJax-Element-36">2-x \to 2</script> as <script type="math/tex" id="MathJax-Element-37">x \to 0</script>.</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-38">\lim_{x \to \frac \pi 2} \frac{\sin(x)}{1-\cos(x)} = 1</script></p>

<p>because <script type="math/tex" id="MathJax-Element-39">\sin(x) \to 1</script> and <script type="math/tex" id="MathJax-Element-40">\cos(x) \to 0</script> as <script type="math/tex" id="MathJax-Element-41">x \to \frac \pi 2</script>.</p>

<p>Finally</p>

<p>as <script type="math/tex" id="MathJax-Element-42">x \to 1+, \ \frac{1+x}{1-x} \to -\infty</script></p>

<p>because <script type="math/tex" id="MathJax-Element-43">1+x \to 2+</script> and <script type="math/tex" id="MathJax-Element-44">1-x \to 0-</script> as <script type="math/tex" id="MathJax-Element-45">x \to 1+</script>.</p>

<p>However, it would be incorrect to state</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-46">\lim_{x \to 1+} \frac{1+x}{1-x} = -\infty</script></p>

<p>because <script type="math/tex" id="MathJax-Element-47">\infty</script> is not a finite value.</p>



<h2 id="maclaurin-series-expansions">Maclaurin Series Expansions</h2>

<p>The Maclaurin series for a function <script type="math/tex" id="MathJax-Element-48">f(x)</script> is defined as</p>

<p><script type="math/tex" id="MathJax-Element-49">f(x) = f(0) + f'(0)x + \frac{f''(0}{2!}x^2 + \frac{f'''(0)}{3!}x^3 + \ ... + \frac{f^{(r)} (0)}{r!}x^r + \ ...</script></p>

<p>where <script type="math/tex" id="MathJax-Element-50">f'</script>, <script type="math/tex" id="MathJax-Element-51">f''</script>, <script type="math/tex" id="MathJax-Element-52">f'''</script>  denote the first, second, and third derivatives of <script type="math/tex" id="MathJax-Element-53">f</script> respectively, and <script type="math/tex" id="MathJax-Element-54">f^{(r)}</script> denotes the derivative of order <script type="math/tex" id="MathJax-Element-55">r</script>.</p>



<h3 id="derivation">Derivation</h3>

<p>To derive the Maclaurin series, the following assumptions are made</p>

<ul>
<li>The function <script type="math/tex" id="MathJax-Element-56">f(x)</script> can be expressed as a series of the form <script type="math/tex" id="MathJax-Element-57">f(x) = a_0 + a_1x + a_2x^2 + a_3x^3 + \ ... + a_rx^r + \ ... </script>, where <script type="math/tex" id="MathJax-Element-58">a_1,\ a_2,\ a_3, \ ...,\ a_r, \ ...</script> are constants.</li>
<li>The series can be differentiated term by term</li>
<li>The function <script type="math/tex" id="MathJax-Element-59">f(x)</script> and all its derivatives exist at <script type="math/tex" id="MathJax-Element-60">x=0</script></li>
</ul>

<p>Successive differentiations of each side of the polynomial representation of <script type="math/tex" id="MathJax-Element-61">f(x)</script> give</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-62">\begin{align} \\ 
&f'(x) = a_1 + 2a_2x + 3a_3x^2 + \ ...\\
&f''(x) = 2a_2 + 2\times 3a_3x + 3\times 4a_4x^2 + \ ... \\
&f'''(x) = 2\times 3a_3 + 2\times3\times4a_4x + \ ...
\end{align}</script></p>

<p>and in general</p>

<p><script type="math/tex" id="MathJax-Element-63">f^{(r)} = 2\times3\times \ ... \times(r-1)\times ra_r </script> terms in <script type="math/tex" id="MathJax-Element-64">x, x^2, x^3, \ ...</script></p>

<p>Putting <script type="math/tex" id="MathJax-Element-65">x=0</script> in the expressions for <script type="math/tex" id="MathJax-Element-66">f(x)</script> and its derivatives, we see that</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-67">\begin{align}\\
&a_0 = f(0)\\
&a_1 = f'(0)\\
&a_2 = \frac{f''(0)}{2} = \frac{f''(0)}{2!} \\
&a_3 = \frac{f'''(0)}{2\times 3} = \frac{f'''(0)}{3!}
 \end{align}</script></p>

<p>and, in general</p>

<p><script type="math/tex" id="MathJax-Element-68">a_r = \frac{f^{(r)}(0)}{1\times 2\times 3 \times \ ... \times (r-1)r} = \frac{f^{(r)}(0)}{r!}</script></p>

<p>Substituting these values into the polynomial series gives the Maclaurin series of f(x).</p>



<h3 id="example">Example</h3>

<p>Find the Maclaurin series of <script type="math/tex" id="MathJax-Element-69">\sin(x)</script></p>



<p><script type="math/tex; mode=display" id="MathJax-Element-70">\begin{alignat*}{3} \\
&f(x) &&= \sin(x) &&&\Rightarrow f(0) &&&&= 0 \\
&f'(x) &&= \cos(x) &&&\Rightarrow f'(0) &&&&= 1 \\
&f''(x) &&= -\sin(x) &&&\Rightarrow f''(0) &&&&= 0 \\
&f'''(x) &&= -\cos(x) &&&\Rightarrow f'''(0) &&&&= -1 \\
&f^{(4)}(x) &&= \sin(x) &&&\Rightarrow f^{(4)}(0) &&&& = 0 \\
&f^{(5)}(x) &&= \cos(x) &&&\Rightarrow f^{(5)}(x) &&&&= 1
\end{alignat*}</script></p>

<p>Substituting these values into the general form of the Maclaurin series gives</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-71">\sin(x) = x - \frac{x^3}{3!} + \frac{x^5}{5!} + \ ...</script></p>

<p>this can be generalised to </p>



<p><script type="math/tex; mode=display" id="MathJax-Element-72">(-1)^r \frac{x^{2r +1}}{(2r+1)!}</script></p>

<p>Where <script type="math/tex" id="MathJax-Element-73">r=0</script> gives the first term <script type="math/tex" id="MathJax-Element-74">r=1</script> the second and so forth, the permissible values of <script type="math/tex" id="MathJax-Element-75">r</script> being <script type="math/tex" id="MathJax-Element-76">r \in \mathbb{Z^*}</script>.</p>



<h3 id="range-of-validity-of-a-series-expansion">Range of validity of a series expansion</h3>

<p>The Maclaurin series may not be valid for all values of <script type="math/tex" id="MathJax-Element-77">x</script>. <br>
for example, the expansion of <script type="math/tex" id="MathJax-Element-78">\frac{1}{1-x}</script> is <script type="math/tex" id="MathJax-Element-79">1 + x + x^2 +\ ... + x^n + \ ...</script>.</p>

<p>For <script type="math/tex" id="MathJax-Element-80">x=2</script> the original equation has the value <script type="math/tex" id="MathJax-Element-81">-1</script>. However, for <script type="math/tex" id="MathJax-Element-82">x=2</script> the expansion takes the value <script type="math/tex" id="MathJax-Element-83">1 + 2 + 2^2 + 2^3 + \ ...</script> which is not equal to <script type="math/tex" id="MathJax-Element-84">-1</script>. The expansion is not valid for <script type="math/tex" id="MathJax-Element-85">x=2</script>.</p>

<p>The range of validity for this expansion can be determined as follows.</p>

<p>The expansion is an infinite geometric series with the first term <script type="math/tex" id="MathJax-Element-86">1</script> and a common ratio <script type="math/tex" id="MathJax-Element-87">x</script>. The sum <script type="math/tex" id="MathJax-Element-88">S_n(x)</script> for the first <script type="math/tex" id="MathJax-Element-89">n</script> terms is given by</p>

<p><script type="math/tex" id="MathJax-Element-90">S_n(x) = \frac{1 - x^{n+1}}{1-x} = \frac{1}{1-x} - \frac{x^{n+1}}{1-x}</script></p>

<p>Hence <script type="math/tex" id="MathJax-Element-91">\frac{1}{1-x} S_n(x) + \frac{x^{n+1}}{1-x}</script> </p>

<p>For the expansion to be valid, S<script type="math/tex" id="MathJax-Element-92">_n(x)</script> must have the same value as <script type="math/tex" id="MathJax-Element-93">\frac{1}{1-x}</script> in the limit when <script type="math/tex" id="MathJax-Element-94">n \to \infty</script>. For this to happen <script type="math/tex" id="MathJax-Element-95">\frac{x^{n+1}}{1-x} \to 0</script> as <script type="math/tex" id="MathJax-Element-96">n \to \infty</script>, which occurs only when <script type="math/tex" id="MathJax-Element-97">|x| < 1</script>.</p>

<p>We can therefore conclude that the Maclaurin series expansion of <script type="math/tex" id="MathJax-Element-98">\frac{1}{1-x}</script> is valid provided <script type="math/tex" id="MathJax-Element-99">|x| < 1.</script></p>

<p>In general, suppose the Maclaurin series of <script type="math/tex" id="MathJax-Element-100">f(x)</script> is given by <script type="math/tex" id="MathJax-Element-101">f(x) = S_n(x) + R_n(x)</script> where <script type="math/tex" id="MathJax-Element-102">S_n(x)</script> is the sum of the first <script type="math/tex" id="MathJax-Element-103">n</script> terms of the series and <script type="math/tex" id="MathJax-Element-104">R_n(x)</script> is the sum of all the remaining terms. <br>
For a particular value of <script type="math/tex" id="MathJax-Element-105">x</script>, the series expansion will be provided that <script type="math/tex" id="MathJax-Element-106">R_n(x) \to 0</script> as <script type="math/tex" id="MathJax-Element-107">n \to \infty</script>.</p>



<h3 id="the-basic-series-expansions">The basic series expansions</h3>

<p>The following expansions are given in the formula booklet, and are often used to derive other expansions</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-108">\begin{align}[1]\ &e^x = 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \ ... + \frac{x^r}{r!} + \ ... \quad &r = (0, 1, 2, \ ...)\\
[2]\ &\sin(x) = x - \frac{x^3}{3!} + \frac{x^5}{5!}-\ ... + (-1)^r \frac{x^{2r+1}}{(2r+1)!}+\ ... \quad &r = (0, 1, 2, \ ...)\\
[3]\ &\cos(x) = 1 - \frac{x^2}{2!} + \frac{x^4}{4!}- \ ... + (-1)^r \frac{x^{2r}}{(2r)!}+\ ... \quad &r = (0, 1, 2, \ ...)\\
[4]\ &\ln(1+x) = x - \frac{x^2}{2} + \frac{x^3}{3}- \ ... + (-1)^{r+1}\frac{x^{2r}}{(2r)!}+\ ... \quad &r=(1, 2, 3, \ ...) \\
[5]\ &(1+x)^n = 1 + nx + \frac{n(n-1)}{2!}x^2 + \ ... + \begin{pmatrix}n \\ r\end{pmatrix}x^r + \ ... \quad &r=(0, 1, 2, \ ...)\end{align}</script></p>

<p>Expansions 1 to 3 are valid for all real values of <script type="math/tex" id="MathJax-Element-109">x</script>.</p>

<p>The expansion of <script type="math/tex" id="MathJax-Element-110">\ln(1+x)</script> is valid for <script type="math/tex" id="MathJax-Element-111">-1 < x \leq 1</script>.</p>

<p>The expansion of <script type="math/tex" id="MathJax-Element-112">(1+x)^n</script> is the binomial series and is valid for any real value of <script type="math/tex" id="MathJax-Element-113">n</script> when <script type="math/tex" id="MathJax-Element-114">-1 < x < 1</script>.  <br>
When <script type="math/tex" id="MathJax-Element-115">n</script> is a positive integer, the series is a finite polynomial of degree n. This makes it value for all real values of <script type="math/tex" id="MathJax-Element-116">x</script> when <script type="math/tex" id="MathJax-Element-117">n</script> is an integer. <br>
One other case is that when <script type="math/tex" id="MathJax-Element-118">x=1</script> the expansion is still valid if <script type="math/tex" id="MathJax-Element-119">n \geq - \frac 1 2</script>.</p>

<p>These expansions can then be used to determine other more complicated expansions.</p>

<blockquote>
  <p>Obtain the first three non-zero terms in the series expansions of <script type="math/tex" id="MathJax-Element-120">x\sin(x^2)</script> and <script type="math/tex" id="MathJax-Element-121">\frac{1}{(1+2x)^{\frac 1 3}}</script> </p>
  
  <p>Firstly, for <script type="math/tex" id="MathJax-Element-122">x\sin(x^2)</script> we use the expansion for <script type="math/tex" id="MathJax-Element-123">\sin(x)</script> substituting <script type="math/tex" id="MathJax-Element-124">x^2</script> in place of <script type="math/tex" id="MathJax-Element-125">x</script>. <br>
   This gives  <br>
   <script type="math/tex" id="MathJax-Element-126">x\sin(x^2) = x\left(x^2 - \frac{(x^2)^3}{3!} + \frac{(x^2)^5}{5!}\right)</script> <br>
   The expansion is valid for all values of <script type="math/tex" id="MathJax-Element-127">x^2</script> and therefore for all values of <script type="math/tex" id="MathJax-Element-128">x</script> </p>
  
  <p>Secondly for <script type="math/tex" id="MathJax-Element-129">\frac{1}{(1+2x)^{\frac 1 3}}</script>  we have  <br>
   <script type="math/tex; mode=display" id="MathJax-Element-130">\begin{align}\frac{1}{(1+2x)^{\frac 1 3}} &= (1+2x)^{-\frac 2 3}\\ 
   &= 1 -\frac 1 3 (2x) + \frac{-\frac 1 3 \times - \frac 4 3}{1\times 2}(2x)^2 + \ ... \\ 
   &= 1 - \frac 2 3 x + \frac 8 9 x^2 + \ ...\end{align}</script> <br>
  The expansion is valid for <script type="math/tex" id="MathJax-Element-131">-1 < 2x < 1 \Rightarrow -\frac 1 2 < x < \frac 1 2</script> </p>
</blockquote>



<h3 id="use-of-series-expansions-to-find-limits">Use of series expansions to find limits</h3>

<p>Consider the function <script type="math/tex" id="MathJax-Element-132">f(x) = \frac{x}{1- \sqrt{1-x}}</script> as <script type="math/tex" id="MathJax-Element-133">x \to 0</script>.</p>

<p>Using the binomial expansion </p>



<p><script type="math/tex; mode=display" id="MathJax-Element-134">\begin{align}\sqrt{1-x} &= (1-x)^{\frac 1 2} \\
&=  1 + \frac1 2 (-x) \frac{\frac 1 2 \times \frac 1 2}{2!}(-x)^2 + \frac{\frac 1 2 \times -\frac 1 2 \times -\frac 3 2}{3!}(-x)^3 + \ ... \\
&= 1 - \frac 1 2 x - \frac 1 8 x^2 - \frac{1}{16} x^3 + \ ...\end{align}</script></p>

<p>Hence </p>



<p><script type="math/tex; mode=display" id="MathJax-Element-135">\begin{align}f(x) &= \frac{x}{1- \left(1 - \frac 1 2 x - \frac 1 8 x^2 - \frac{1}{16}x^3 + \ ... \right)} \\
&= \frac{x}{\frac 1 2 x + \frac 1 8 x^2 + \frac{1}{16}x^3 + \ ...} \\
&= \frac{1}{\frac 1 2 + \frac 1 8 x + \frac{1}{16} x^3} \end{align}</script></p>

<p>It can now be seen that when <script type="math/tex" id="MathJax-Element-136">x\to 0</script>, all the terms in the denominator, except the first, tend to zero. <br>
Hence,  <br>
<script type="math/tex; mode=display" id="MathJax-Element-137">\lim_{x\to 0} f(x) = \frac{1}{\frac 1 2} = 2</script></p>



<h3 id="important-limits">Important limits</h3>



<h4 id="the-limit-of-xke-x-x-to-infty">The limit of <script type="math/tex" id="MathJax-Element-138">x^ke^{-x}, x \to \infty</script></h4>

<p>First consider the function <script type="math/tex" id="MathJax-Element-139">x^2e^{-x}</script>. When x becomes very large, <script type="math/tex" id="MathJax-Element-140">x^2</script> becomes very large, and <script type="math/tex" id="MathJax-Element-141">e^{-x}</script> becomes very small. <br>
As <script type="math/tex" id="MathJax-Element-142">e^{-x}</script> gets smaller at a greater rate than <script type="math/tex" id="MathJax-Element-143">x^2</script> increases, the result tends to 0. <br>
when <script type="math/tex" id="MathJax-Element-144">x \to \infty</script>, <script type="math/tex" id="MathJax-Element-145">x^ke^{-k} \to 0, \ k \in \mathbb{R}</script></p>



<h5 id="proof">Proof</h5>

<blockquote>
  <p>First note that when <script type="math/tex" id="MathJax-Element-146">k = 0</script>, and <script type="math/tex" id="MathJax-Element-147">x \neq 0 </script> the expression <script type="math/tex" id="MathJax-Element-148">x^k e^{-x}</script> becomes <script type="math/tex" id="MathJax-Element-149">e^{-x}</script> which tends to zero as <script type="math/tex" id="MathJax-Element-150">x \to \infty</script>. <br>
  The result therefore holds in this case. <br>
  Further, when <script type="math/tex" id="MathJax-Element-151">k < 0</script>, both <script type="math/tex" id="MathJax-Element-152">x^k</script> and <script type="math/tex" id="MathJax-Element-153">e^{-x}</script> tend to zero as <script type="math/tex" id="MathJax-Element-154">x \to \infty</script> so the product of the two must also tend to 0. Therefore the result holds for this case as well.</p>
  
  <p>Finally, suppose that <script type="math/tex" id="MathJax-Element-155">k > 0</script>. Let <script type="math/tex" id="MathJax-Element-156">n</script> be an integer such that <script type="math/tex" id="MathJax-Element-157">n > k</script>. <br>
  Using the series expansion for <script type="math/tex" id="MathJax-Element-158">e^x</script> we have <br>
  <script type="math/tex; mode=display" id="MathJax-Element-159">\begin{align}x^ke^{-x} &= \dfrac{x^k}{e^x} \\
 &= \dfrac{x^k}{1 + x + \dfrac{x^2}{2!} + {\ ...} + \dfrac{x^n}{n!} + \dfrac{x^{n+1}}{(n+1)!} + \dfrac{x^{n+2}}{(n+2)!}+ {\ ...}} \\
 &= \dfrac{x^{k-n}}{x^{-n} + x^{1-n} + \dfrac{x^{2-n}}{2!} +{ \ ...} + \dfrac{1}{n!} + \dfrac{x}{(n+1)!} + \dfrac{x^2}{(n+2)!}+ {\ ...}} \end{align}</script> <br>
  As <script type="math/tex" id="MathJax-Element-160">n>k</script>, <script type="math/tex" id="MathJax-Element-161">k-n</script> is negative. Hence, when <script type="math/tex" id="MathJax-Element-162">x \to \infty</script>, <script type="math/tex" id="MathJax-Element-163">x^{k-n} \to 0</script>. <br>
  In the denominator, all of the terms are positive, and all of those after <script type="math/tex" id="MathJax-Element-164">\frac{1}{n!}</script> tend to infinity as <script type="math/tex" id="MathJax-Element-165">x \to \infty</script>. <br>
  Hence, when <script type="math/tex" id="MathJax-Element-166">x \to \infty</script> the denominator of the expression tends to infinity. <br>
  It follows that <br>
  <script type="math/tex; mode=display" id="MathJax-Element-167">x^ke^{-k} \to \frac 0 \infty = 0</script> <br>
  No matter how large the value of <script type="math/tex" id="MathJax-Element-168">k</script> may be, <script type="math/tex" id="MathJax-Element-169">x^ke^{-k} \to 0</script> as <script type="math/tex" id="MathJax-Element-170">x \to \infty</script> still holds. Therefore, for large values of <script type="math/tex" id="MathJax-Element-171">x</script>, the influence of <script type="math/tex" id="MathJax-Element-172">e^{-x}</script> is stronger than any power of <script type="math/tex" id="MathJax-Element-173">x</script>.</p>
</blockquote>



<h4 id="the-limit-of-xk-lnx-as-x-to-0">The limit of <script type="math/tex" id="MathJax-Element-174">x^k \ln(x)</script> as <script type="math/tex" id="MathJax-Element-175">x \to 0</script></h4>

<p>Consider the function <script type="math/tex" id="MathJax-Element-176">x^k \ln(x)</script> where <script type="math/tex" id="MathJax-Element-177">k >0</script>. <script type="math/tex" id="MathJax-Element-178">x</script> must be restricted to <script type="math/tex" id="MathJax-Element-179">\mathbb{R^+}</script> as <script type="math/tex" id="MathJax-Element-180">\ln(x)</script> is only real for this set.</p>

<p>When <script type="math/tex" id="MathJax-Element-181">x \to 0</script>, <script type="math/tex" id="MathJax-Element-182">x^k \to 0</script> and <script type="math/tex" id="MathJax-Element-183">\ln(x) \to -\infty</script>. It is not obvious what happens to the product as <script type="math/tex" id="MathJax-Element-184">x \to 0</script>.</p>

<p>As <script type="math/tex" id="MathJax-Element-185">x \to 0</script>, <script type="math/tex" id="MathJax-Element-186">x^k\ln(x) \to 0</script> for all <script type="math/tex" id="MathJax-Element-187">k > 0</script></p>



<h5 id="proof-1">Proof</h5>

<blockquote>
  <p>Let <script type="math/tex" id="MathJax-Element-188"> x = e^{-\frac y k}</script>. Then when <script type="math/tex" id="MathJax-Element-189">y \to \infty</script>, <script type="math/tex" id="MathJax-Element-190">x \to 0</script>. Also <script type="math/tex" id="MathJax-Element-191">x^k = e^{-y}</script> and <script type="math/tex" id="MathJax-Element-192">\ln(x)  = -\frac y k</script>. Hence, <br>
  <script type="math/tex; mode=display" id="MathJax-Element-193">\begin{align}
 \lim_{x \to 0}\left(x^k\ln(x)\right) &= \lim_{y \to \infty}\left(-\frac y k e^{-y}\right) \\
 &= -\frac 1 k \lim_{y \to \infty} \left(y e^{-y} \right) \end{align}</script> <br>
  Using the established limit for <script type="math/tex" id="MathJax-Element-194">x^ke^{-k}</script> with <script type="math/tex" id="MathJax-Element-195">k = 1</script>, we have <script type="math/tex" id="MathJax-Element-196">\lim \limits_{y \to \infty}\left(ye^{-y} \right)  = 0</script>  <br>
  Hence <script type="math/tex; mode=display" id="MathJax-Element-197">\lim_{x\to 0}{\left(x^k \ln(k)\right)}</script> </p>
  
  <p>For small values of <script type="math/tex" id="MathJax-Element-198">x</script>, <script type="math/tex" id="MathJax-Element-199">x^k \ln(k)</script> will be negative because <script type="math/tex" id="MathJax-Element-200">\ln(x) < 0 </script> for <script type="math/tex" id="MathJax-Element-201">0 < x < 1</script>. Hence the limit is approached from negative values.</p>
  
  <p>We then have <script type="math/tex" id="MathJax-Element-202">x^k \ln(x) \to 0- </script> when <script type="math/tex" id="MathJax-Element-203">x \to 0+ \quad (k > 0)</script></p>
</blockquote>



<h3 id="improper-integrals">Improper integrals</h3>

<p>Consider the integral <script type="math/tex" id="MathJax-Element-204">I_1 = \int_0^{\infty}\frac{1}{1+x^2} dx</script>. <br>
This integral gives the area of the region <script type="math/tex" id="MathJax-Element-205">R_1</script> in the first quadrant enclosed by the curve <script type="math/tex" id="MathJax-Element-206">y = \frac{1}{1+x^2}</script> the <script type="math/tex" id="MathJax-Element-207">x</script> axis and the <script type="math/tex" id="MathJax-Element-208">y</script> axis. <br>
It is unclear whether the area will have a finite value, as the upper bound of the integral is infinite.</p>

<p>To investigate this, the upper bound is replaced by <script type="math/tex" id="MathJax-Element-209">c</script>. <br>
We then have  <br>
<script type="math/tex; mode=display" id="MathJax-Element-210">\begin{align}I_1 &= \int_0^c \frac{1}{1+x^2}dx \\
&= \left[ \operatorname{atan}(x) \right]_0^c \\ 
&= \operatorname{atan}(c)\end{align}</script> </p>

<p>Now let <script type="math/tex" id="MathJax-Element-211">c \to \infty</script> and it can be seen that <script type="math/tex" id="MathJax-Element-212">I_1 \to \frac{\pi}{2} </script> because <script type="math/tex" id="MathJax-Element-213">\operatorname{atan}(c) \to \frac{\pi}{2}</script>. <br>
The area of the region <script type="math/tex" id="MathJax-Element-214">R_1</script> is therefore <script type="math/tex" id="MathJax-Element-215">\frac{\pi}{2}</script>.</p>

<p>Next consider the integral <script type="math/tex" id="MathJax-Element-216">I_2 = \int_0^4 \frac{1}{x^{\frac 1 2}} dx</script>. This gives the area of the region <script type="math/tex" id="MathJax-Element-217">R_2</script> bounded by the curve <script type="math/tex" id="MathJax-Element-218">y = \frac{1}{x^{\frac 1 2}}</script> the <script type="math/tex" id="MathJax-Element-219">x</script> axis, the <script type="math/tex" id="MathJax-Element-220">y</script> axis and the ordinate <script type="math/tex" id="MathJax-Element-221">x=4</script>.</p>

<p><script type="math/tex" id="MathJax-Element-222">R_2</script> is an unbounded region because <script type="math/tex" id="MathJax-Element-223">y \to \infty</script> as <script type="math/tex" id="MathJax-Element-224">x \to 0</script>. <br>
To determine whether <script type="math/tex" id="MathJax-Element-225">R_2</script> is finite we replace the lower limit with <script type="math/tex" id="MathJax-Element-226">c</script>.</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-227">\begin{align}I_2 &= \int_c^4 \frac{1}{x^{\frac 1 2}} dx \\
&= \left[2x^{\frac 1 2} \right]_c^0 \\
&= 4 - 2c^{\frac 1 2} \end{align}</script></p>

<p>Now let <script type="math/tex" id="MathJax-Element-228">c \to 0</script> and it can be seen that <script type="math/tex" id="MathJax-Element-229">I_2 \to 4</script>. The area of <script type="math/tex" id="MathJax-Element-230">R_2</script> is therefore equal to 4.</p>

<p>The formal definition of an improper integral is as follows</p>

<p>The integral <script type="math/tex" id="MathJax-Element-231">\int _a^b f(x)\ dx</script> is said to be improper if:</p>

<ul>
<li>The interval of integration is infinite</li>
<li>The integrand is not defined at either of the limits</li>
<li>The integrand is not defined at one or more of the points bounded by the limits of the integral</li>
</ul>



<h2 id="polar-coordinates">Polar coordinates</h2>

<p>Let <script type="math/tex" id="MathJax-Element-232">O</script>  be a fixed point and <script type="math/tex" id="MathJax-Element-233">OL</script> a fixed line in the plane. For any point <script type="math/tex" id="MathJax-Element-234">P</script>, let the distance of <script type="math/tex" id="MathJax-Element-235">P</script> from <script type="math/tex" id="MathJax-Element-236">O</script> be <script type="math/tex" id="MathJax-Element-237">r</script> and the angle that <script type="math/tex" id="MathJax-Element-238">OP</script> makes with <script type="math/tex" id="MathJax-Element-239">OL</script> be <script type="math/tex" id="MathJax-Element-240">\theta</script>.</p>

<p><script type="math/tex" id="MathJax-Element-241">r</script> and <script type="math/tex" id="MathJax-Element-242">\theta</script> are then the polar coordinates of <script type="math/tex" id="MathJax-Element-243">P</script>.</p>

<p>The point <script type="math/tex" id="MathJax-Element-244">O</script> is called the pole and <script type="math/tex" id="MathJax-Element-245">OL</script> is called the initial line. <br>
The angle <script type="math/tex" id="MathJax-Element-246">\theta</script> is measured in radians. <br>
Positive values of <script type="math/tex" id="MathJax-Element-247">\theta</script> correspond to an anticlockwise rotation from <script type="math/tex" id="MathJax-Element-248">OL</script>, and negative values to a clockwise rotation.</p>

<p>The AQA specification defines <script type="math/tex" id="MathJax-Element-249">r</script> as being non-negative.</p>



<h3 id="restrictions-on-the-values-of-theta">Restrictions on the values of <script type="math/tex" id="MathJax-Element-250">\theta</script></h3>

<p>To ensure that each point in the plane, other than the pole <script type="math/tex" id="MathJax-Element-251">O</script>, has only one pair of polar coordinates, the values that <script type="math/tex" id="MathJax-Element-252">\theta</script> can take will sometimes be restricted. <br>
The pole is an exception as it is defined by <script type="math/tex" id="MathJax-Element-253">r = 0 </script> without reference to <script type="math/tex" id="MathJax-Element-254">\theta</script>.</p>



<h3 id="the-relationship-between-cartesian-and-polar-coordinates">The relationship between Cartesian and polar coordinates</h3>

<p>We have </p>

<p><script type="math/tex" id="MathJax-Element-255">x = r\cos(\theta)</script></p>

<p><script type="math/tex" id="MathJax-Element-256">y = r\sin(\theta)</script></p>

<p><script type="math/tex" id="MathJax-Element-257">r^2 = x^2 + y^2</script></p>

<p><script type="math/tex" id="MathJax-Element-258">\tan(\theta) = \frac y x</script></p>



<h3 id="example-1">Example</h3>

<blockquote>
  <p>The values of A and B have polar coordinates <script type="math/tex" id="MathJax-Element-259">\left(3, \frac \pi 6 \right)</script> and <script type="math/tex" id="MathJax-Element-260">\left(4, -\frac \pi 3 \right)</script> respectively.</p>
  
  <p>Show that AB = 5</p>
  
  <p><script type="math/tex" id="MathJax-Element-261">AB = \sqrt{(x_B - x_A)^2 + (y_B - y_A)^2}</script> <br>
    We have</p>
  
  <p><script type="math/tex" id="MathJax-Element-262">x_B = 4\times \cos(-\frac \pi 3) \quad x_A = 3 \times \cos(\frac \pi 6)</script> <br>
    <script type="math/tex" id="MathJax-Element-263">y_B = 4 \times \sin(-\frac \pi 3) \quad y_A = 3 \times \sin(\frac \pi 6)</script> </p>
  
  <p><script type="math/tex" id="MathJax-Element-264">AB</script> is then <script type="math/tex" id="MathJax-Element-265">\sqrt{25} = 5</script></p>
  
  <p>Alternatively, we can find the distance without converting to cartesian form given that the distance between two polar points <script type="math/tex" id="MathJax-Element-266">(r_1, \theta_1)</script> and <script type="math/tex" id="MathJax-Element-267">(r_2, \theta_2)</script> is given by <br>
     <script type="math/tex" id="MathJax-Element-268">\sqrt{r_1^2 + r_2^2 - 2r_1r_2\cos(\theta_1 - \theta_2)}</script> <br>
     Which also gives <script type="math/tex" id="MathJax-Element-269">AB = 5</script>.</p>
</blockquote>



<h3 id="representations-of-curves-in-polar-form">Representations of curves in polar form</h3>

<p>If a point <script type="math/tex" id="MathJax-Element-270">P</script> with Cartesian coordinates <script type="math/tex" id="MathJax-Element-271">(x, y)</script> moves on a circle of radius <script type="math/tex" id="MathJax-Element-272">a</script> and centre <script type="math/tex" id="MathJax-Element-273">C(a, 0)</script>, then, for all positions of <script type="math/tex" id="MathJax-Element-274">P</script>,</p>

<p><script type="math/tex" id="MathJax-Element-275">(x-a)^2 + y^2 = a^2</script></p>

<p>This is the Cartesian equation of the circle.</p>

<p>Now let <script type="math/tex" id="MathJax-Element-276">P</script> have polar coordinates <script type="math/tex" id="MathJax-Element-277">(r, \theta)</script>. The circle intersects the positive <script type="math/tex" id="MathJax-Element-278">x</script> axis at the point <script type="math/tex" id="MathJax-Element-279">A(2a, 0)</script>.  <br>
Hence from the triangle <script type="math/tex" id="MathJax-Element-280">OAP</script> we have <script type="math/tex" id="MathJax-Element-281">r = 2a\cos(\theta)</script>.</p>

<p>This is the polar equation of the circle. Note that the equation is valid for negative values of <script type="math/tex" id="MathJax-Element-282">\theta</script> because <script type="math/tex" id="MathJax-Element-283">\cos(-\theta)=\cos(\theta)</script>.</p>

<p>There are many examples of curves whose properties are more easily investigated using a polar equation rather than a Cartesian equation.</p>

<ul>
<li>The equation <script type="math/tex" id="MathJax-Element-284">r=a</script> which represents a circle centred at <script type="math/tex" id="MathJax-Element-285">O</script> and of radius <script type="math/tex" id="MathJax-Element-286">a</script>   </li>
<li>The equation <script type="math/tex" id="MathJax-Element-287">\theta = \alpha</script> represents a semi-infinite straight line <script type="math/tex" id="MathJax-Element-288">OA</script> radiating from the origin and making an angle of <script type="math/tex" id="MathJax-Element-289">\alpha</script> with the initial line <script type="math/tex" id="MathJax-Element-290">OL</script>.</li>
</ul>



<h1 id="introduction-to-differential-equations">Introduction to differential equations</h1>



<h2 id="order-and-linearity">Order and linearity</h2>

<p>When only the first order derivative <script type="math/tex" id="MathJax-Element-291">\frac{dy}{dx}</script> is involved, the differential equation is said to be of first order. When the second order derivative <script type="math/tex" id="MathJax-Element-292">\frac{d^2y}{dx^2}</script> is involved the derivative is of second order. <br>
An order <script type="math/tex" id="MathJax-Element-293">n</script> derivative involves <script type="math/tex" id="MathJax-Element-294">\frac{d^ny}{dx^n}</script>.</p>

<p>A differential equation is said to be linear if it is linear in the dependent variable <script type="math/tex" id="MathJax-Element-295">y</script> and the derivatives of <script type="math/tex" id="MathJax-Element-296">y</script>.</p>

<p>This can also be defined by the statement: ‘a differential equation is linear if the highest order derivative of the dependent variable <script type="math/tex" id="MathJax-Element-297">y</script> can be expressed as a linear function of <script type="math/tex" id="MathJax-Element-298">y</script> and the lower order derivatives.’. <br>
Hence, for a second order differential equation to be linear, it must be possible to express <script type="math/tex" id="MathJax-Element-299">\frac{d^2y}{dx^2}</script> in the form</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-300">\frac{d^2y}{dx^2} = f(x) + g(x)y + h(x)\frac{dy}{dx}</script></p>

<p>where <script type="math/tex" id="MathJax-Element-301">f</script>, <script type="math/tex" id="MathJax-Element-302">g</script>, and <script type="math/tex" id="MathJax-Element-303">h</script> are functions of <script type="math/tex" id="MathJax-Element-304">x</script> only.</p>



<h3 id="example-2">Example</h3>

<blockquote>
  <p>State order of each of the following differential equations and whether they are linear <br>
  a) <script type="math/tex" id="MathJax-Element-305">x\frac{dy}{dx} + y = x^2</script> <br>
  Order 1, linear</p>
  
  <p>b) <script type="math/tex" id="MathJax-Element-306">\frac{d^2y}{dx^2} + \frac{dy}{dx} + y = 0</script> <br>
  Order 2, linear</p>
  
  <p>c) <script type="math/tex" id="MathJax-Element-307">\frac{dy}{dx} = x^3 + y^3</script>  <br>
  Order 1, non-linear</p>
  
  <p>d) <script type="math/tex" id="MathJax-Element-308">x\left(\frac{dy}{dx}\right)^2 + y = 1</script> <br>
  Order 1, non-linear</p>
</blockquote>



<h2 id="families-of-solutions-general-solutions-and-particular-solutions">Families of solutions, general solutions, and particular solutions</h2>

<p>A differential equation of the form <script type="math/tex" id="MathJax-Element-309">\frac{dy}{dx} = f(x)</script> is solved by integrating each side, to give a function <script type="math/tex" id="MathJax-Element-310">y(x) = \int f(x)\ dx</script>.</p>

<p>A differential equation of the form <script type="math/tex" id="MathJax-Element-311">\frac{dy}{dx} = f(x)g(y)</script> can be solved by separation of variables, which involves rewriting the equation as <script type="math/tex" id="MathJax-Element-312">\frac{1}{g(y)} \frac{dy}{dx} = f(x)</script>, integrating both sides with respect to <script type="math/tex" id="MathJax-Element-313">x</script>, and solving for <script type="math/tex" id="MathJax-Element-314">y</script>.</p>

<p>The set of all possible solutions for a differential equation is said to form a family of solutions. <br>
Particular members of the family of solutions are solutions with a particular value for the constant of integration.</p>

<p>Solutions which involve arbitrary constants are called general solutions because they represent the whole family of possible solutions. <br>
A solution which satisfies the differential equation but contains no arbitrary constants is called a particular solution. <br>
General solutions of first order differential equations always contain exactly one arbitrary constant.</p>

<p>In most of the applications of differential equations, a particular solution valid over some specified interval is required. The required solution of a first order differential equation is often chosen in order to satisfy a given condition at an end point of an interval under consideration.</p>



<h3 id="example-3">Example</h3>

<blockquote>
  <p>The function <script type="math/tex" id="MathJax-Element-315">y(x)</script> satisfies the differential equation  <br>
  <script type="math/tex; mode=display" id="MathJax-Element-316">x^2 \frac{dy}{dx} - y^2 = 0, \quad x \geq 1</script></p>
  
  <p>a) Find the general solution for <script type="math/tex" id="MathJax-Element-317">y(x)</script></p>
  
  <p>Writing the differential equation as <script type="math/tex" id="MathJax-Element-318">\frac{dy}{dx} = \frac{x^2}{y^2}</script> and separating the variables we have <br>
    <script type="math/tex; mode=display" id="MathJax-Element-319">\int \frac{dy}{y^2} = \int \frac{dx}{x^2}</script> <br>
    giving  <br>
    <script type="math/tex; mode=display" id="MathJax-Element-320">-\frac 1 y = -\frac 1 x + C</script> <br>
    Hence  <br>
    <script type="math/tex; mode=display" id="MathJax-Element-321">y = \frac{x}{1- Cx}</script></p>
  
  <p>b) Hence find the particular solution satisfying the boundary condition <script type="math/tex" id="MathJax-Element-322">y(1) = \frac 1 2</script> </p>
  
  <p>Applying the boundary condition gives <br>
    <script type="math/tex; mode=display" id="MathJax-Element-323">\frac 1 2 = \frac{1}{1-C}</script> <br>
    Hence <script type="math/tex" id="MathJax-Element-324">C = -1</script>. The required particular solution is therefore</p>
  
  <p><script type="math/tex; mode=display" id="MathJax-Element-325">y = \frac{x}{1+x}</script></p>
</blockquote>



<h1 id="numerical-methods-for-the-solution-of-first-order-differential-equations">Numerical methods for the solution of first order differential equations</h1>

<p>These formula are concerned with differential equations of the form </p>

<p><script type="math/tex" id="MathJax-Element-326">\frac{dy}{dx} = f(x, y)</script> subject to the boundary conditions of the form <script type="math/tex" id="MathJax-Element-327">y(x_0) = y_0</script>.</p>

<p>In each case, the solution <script type="math/tex" id="MathJax-Element-328">y(x)</script>, valid for <script type="math/tex" id="MathJax-Element-329">x \geq x_0</script> is required.</p>

<p>The basic idea of all the numerical methods is to use a step-by-step procedure to obtain approximations to the values of <script type="math/tex" id="MathJax-Element-330">y_1, y_2, y_3,\ \ ...</script> successively. <br>
The interval, <script type="math/tex" id="MathJax-Element-331">h</script>, between successive x-values is called the step length. <br>
Some of the methods of obtaining these approximations are suggested by geometrical considerations of the graph.</p>



<h2 id="eulers-formula">Euler’s formula</h2>

<p>One way of obtaining an approximation to the value of <script type="math/tex" id="MathJax-Element-332">y_1</script> is to assume that the part of the curve between <script type="math/tex" id="MathJax-Element-333">P_0</script> and <script type="math/tex" id="MathJax-Element-334">P_1</script> is a straight line segment with a gradient equal to the gradient of the curve at <script type="math/tex" id="MathJax-Element-335">P_0</script>.</p>

<p>Since <script type="math/tex" id="MathJax-Element-336">\frac{dy}{dx} = f(x, y)</script> , the gradient of the curve at <script type="math/tex" id="MathJax-Element-337">P_0</script> is <script type="math/tex" id="MathJax-Element-338">f(x_0, y_0)</script>. Hence with this approximation</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-339">\frac{y_1 - y+0}{h} = f(x_0, y_0)</script></p>



<p><script type="math/tex; mode=display" id="MathJax-Element-340">y_1 = y_0 + hf(x_0, y_0)</script> </p>

<p>Using this approximation to obtain the value of <script type="math/tex" id="MathJax-Element-341">y</script> at <script type="math/tex" id="MathJax-Element-342">P_1</script>, the process can be repeated, assuming that the part of the curve between <script type="math/tex" id="MathJax-Element-343">P_1</script> and <script type="math/tex" id="MathJax-Element-344">P_2</script> is a straight line segment with gradient equal to the value of <script type="math/tex" id="MathJax-Element-345">\frac{dy}{dx}</script> at <script type="math/tex" id="MathJax-Element-346">P_1</script>. <br>
This gives <script type="math/tex" id="MathJax-Element-347">y_2 = y_1 + hf(x_1, y_1)</script>. <br>
Continuing in this manner we have the general form</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-348">y_{r+1} = y_r + hf(x_r, y_r), \quad r \in \mathbb{Z}^+_0</script></p>

<p>This is Euler’s formula. Successive calculation of values of <script type="math/tex" id="MathJax-Element-349">y</script> using this formula is known as Euler’s method. It is clear from the nature of the linear approximation on which this method is based that the step length <script type="math/tex" id="MathJax-Element-350">h</script> needs to be relatively small in order to achieve reasonable accuracy.</p>



<h3 id="example-4">Example</h3>

<blockquote>
  <p>The function <script type="math/tex" id="MathJax-Element-351">y(x)</script> satisfies the differential equation <script type="math/tex" id="MathJax-Element-352">\frac{dy}{dx} = \sin(x + y)</script> and the condition <script type="math/tex" id="MathJax-Element-353">y(1) = 0</script>. <br>
  Use Euler’s formula to estimate the values of <script type="math/tex" id="MathJax-Element-354">y(1.1), y(1.2), y(1.3)</script>, giving the answers to four decimal places.</p>
  
  <p>In this case <script type="math/tex" id="MathJax-Element-355">x_0 = 1</script>, <script type="math/tex" id="MathJax-Element-356">y_0 = 0</script>, <script type="math/tex" id="MathJax-Element-357">h = 0.1</script> and <script type="math/tex" id="MathJax-Element-358">f(x, y) = \sin(x + y)</script>. <br>
   Also <script type="math/tex" id="MathJax-Element-359">y(1.1) = y_1</script>, <script type="math/tex" id="MathJax-Element-360">y(1.2) = y_2</script>, and <script type="math/tex" id="MathJax-Element-361">y(1.3) = y_3</script>. <br>
   Using Euler’s formula <br>
   <script type="math/tex; mode=display" id="MathJax-Element-362">\begin{align}y_1 &= y_0 + h\sin(x_0 + y_0) \\
    &= 0.1\sin(1) \\
    &\approx 0.08414709848\\
    &\approx 0.0841\ (\text{4 d.p})\end{align}</script> <br>
  <script type="math/tex; mode=display" id="MathJax-Element-363">\begin{align}y_2 &= y_1+ h\sin(x_1 + y_1) \\
    &= 0.08414709848 +0.1\sin(1.1 + 0.08414709848) \\
    &\approx 0.1767648775\\
    &\approx 0.1768\ (\text{4 d.p})\end{align}</script> <br>
  <script type="math/tex; mode=display" id="MathJax-Element-364">\begin{align}y_3 &= y_2+ h\sin(x_2 + y_2) \\
    &= 0.1767648775 +0.1\sin(1.2 + 0.1767648775) \\
    &\approx 0.2748883657\\
    &\approx 0.2749\ (\text{4 d.p})\end{align}</script></p>
</blockquote>

<p>Note that at each stage after the first, the previous value of <script type="math/tex" id="MathJax-Element-365">y</script> should be used to the maximum available precision.</p>



<h2 id="the-mid-point-formula">The Mid-Point formula</h2>

<p>Consider three points, <script type="math/tex" id="MathJax-Element-366">P_{r-1}</script>, <script type="math/tex" id="MathJax-Element-367">P_r</script>, and <script type="math/tex" id="MathJax-Element-368">P_{r+1}</script> on part of a curve representing the solution of the differential equation <script type="math/tex" id="MathJax-Element-369">\frac{dy}{dx} = f(x,y)</script>. <br>
Provided that the three points are reasonably close together, the gradient of the line segment joining <script type="math/tex" id="MathJax-Element-370">P_{r-1}</script> and <script type="math/tex" id="MathJax-Element-371">P_{r+1}</script> will be approximately the same as the gradient of the tangent to the curve at <script type="math/tex" id="MathJax-Element-372">P_r</script>.</p>

<p>Since <script type="math/tex" id="MathJax-Element-373">\frac{dy}{dx} = f(x_r, y_r)</script> at <script type="math/tex" id="MathJax-Element-374">P_r</script>, this approximation gives</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-375">\frac{y_{r+1} - y_{r-1}}{2h} = f(x_r, y_r)</script></p>



<p><script type="math/tex; mode=display" id="MathJax-Element-376">y_{r+1} = y_{r-1} + 2hf(x_r, y_r)</script></p>

<p>Since only the value of <script type="math/tex" id="MathJax-Element-377">y_{r-1}</script>  is known, it is necessary t calculate <script type="math/tex" id="MathJax-Element-378">y_r</script> by another means.</p>



<h3 id="example-5">Example</h3>

<blockquote>
  <p>The function <script type="math/tex" id="MathJax-Element-379">y(x)</script> satisfies the differential equation <script type="math/tex" id="MathJax-Element-380">\frac{dy}{dx} = 1 + \sqrt{xy}</script> and the condition <script type="math/tex" id="MathJax-Element-381">y(0) = 1</script>. <br>
  Use the mid-point formula with a step length of <script type="math/tex" id="MathJax-Element-382">0.25</script> to obtain an approximate value for <script type="math/tex" id="MathJax-Element-383">y(1)</script> to three decimal places. </p>
  
  <p><script type="math/tex" id="MathJax-Element-384">x_0 = 0,\ y_0 =1,\ h=0.25,\ f(x, y) = 1 + \sqrt{xy}</script> </p>
  
  <p>Euler’s formula gives <br>
   <script type="math/tex; mode=display" id="MathJax-Element-385">\begin{align}y(0.25) = y_1 &= y_0 +h(1 + \sqrt{x_0 y_0}) \\ 
   &= 1 + 0.25 \times 1 \\ 
   &= 1.25\end{align}</script> <br>
  The mid-point formula gives <br>
  <script type="math/tex; mode=display" id="MathJax-Element-386"> \begin{alignat*}{3}
    &y(0.5) &&=y_2 &&&=y_1 + 2h(1 + \sqrt{x_1 y_1}) &&&&\\
		    &\ &&\  &&&= 1+ 0.5(1 + \sqrt{0.25 \times 1.25}) &&&&\\
		    &\ &&\ &&&\approx 1.77951 &&&&\\
    &y(0.75) &&=y_3 &&&= 2h(1+ \sqrt{x_2 y_2}) &&&&\\
		    &\ &&\  &&&= 1.25 + 0.5(1 + \sqrt{0.5 \times 1.77951}) &&&& \\
		    &\ &&\ &&&\approx 2.22163 &&&&\\
    &y(1) &&=y_4 &&&= y_2 + 2h(1 + \sqrt{x_3 y_3}) &&&& \\
            &\ &&\  &&&= 1.77951 + 0.5(1 + \sqrt{0.75 \times 2.22163})&&&& \\
		    &\ &&\ &&&\approx 2.92492 &&&&\\
\end{alignat*}</script> </p>
</blockquote>



<h2 id="the-improved-euler-formula">The Improved Euler formula</h2>

<p>Another formula can be obtained by assuming that the gradient of <script type="math/tex" id="MathJax-Element-387">P_r P_{r+1}</script> is equal to the average of the values of <script type="math/tex" id="MathJax-Element-388">\frac{dy}{dx}</script> at <script type="math/tex" id="MathJax-Element-389">P_r</script> and <script type="math/tex" id="MathJax-Element-390">P_{r+1}</script>.</p>

<p>With this assumption</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-391">\frac{y_{r+1} - y_r}{h} = \frac 1 2 [f(x_r, y_r) + f(x_{r+1}, y_{r+1})]</script></p>

<p>Hence </p>



<p><script type="math/tex; mode=display" id="MathJax-Element-392">y_{r+1} = y_r + \frac h 2 [f(x_r, y_r) + f(x_{r+1}, y_{r+1}^*)]</script></p>

<p>Where <script type="math/tex" id="MathJax-Element-393">y_{r+1}^*</script> is an approximation for <script type="math/tex" id="MathJax-Element-394">y_{r+1}</script>, often obtained by Euler’s formula. </p>



<h3 id="example-6">Example</h3>

<blockquote>
  <p>The function <script type="math/tex" id="MathJax-Element-395">y(x)</script> satisfies the differential equation <script type="math/tex" id="MathJax-Element-396">\frac{dy}{dx} = \ln(x+y), \quad x \geq 1</script>. <br>
  The boundary condition is <script type="math/tex" id="MathJax-Element-397">y(1) = 1</script>. Use the improved Euler formula with a step length of <script type="math/tex" id="MathJax-Element-398">0.25</script> to estimate the value of <script type="math/tex" id="MathJax-Element-399">y(1.5)</script></p>
  
  <p><script type="math/tex" id="MathJax-Element-400">x_0 = 1,\ y_0 = 1, \ h = 0.25, \text{and}\ f(x,y) = \ln(x+y)</script>  <br>
   the first estimate of <script type="math/tex" id="MathJax-Element-401">y_1</script> is obtained by Euler’s formula <br>
   <script type="math/tex; mode=display" id="MathJax-Element-402">\begin{align}y_1^* &= y_0 + h\ln(x_0 + y_0) \\
    &= 1 + 0.25\ln(2) \\
    &\approx 1.17329\end{align}</script> <br>
  For <script type="math/tex" id="MathJax-Element-403">y_{1}</script> we then have <br>
  <script type="math/tex; mode=display" id="MathJax-Element-404">\begin{align}y_1 &= y_0 + \frac h 2 [\ln(x_0 + y_0) + \ln(x_1 + y_1)] \\
  &= 1 + 0.125[\ln(2) + \ln(1.25 + 1.19728)] \\
  &\approx 1.42102\end{align}</script> <br>
  We can now use Euler’s formula with the improved value of <script type="math/tex" id="MathJax-Element-405">y_1</script> to give <br>
  <script type="math/tex; mode=display" id="MathJax-Element-406">\begin{align}y_2^* &= y_1 + h\ln(x_1 +y_1) \\
    &= 1.19728 + 0.25\ln(1.25 + 1.19728) \\
    &\approx 1.42102\end{align}</script> <br>
  And finally  <br>
  <script type="math/tex; mode=display" id="MathJax-Element-407">\begin{align}y_2 &= y_1 + \frac h 2 [\ln(x_1 + y_1) + \ln(x_2 + y_2^*)] \\
   &= 1.19728 + 0.125[\ln(1.25 + 1.19728) + \ln(1.5  1.42102)] \\
   &\approx 1.443\end{align}</script></p>
</blockquote>



<h2 id="alternative-calculation-for-the-improved-euler-method">Alternative calculation for the improved Euler method</h2>

<p>By substituting the the expression for <script type="math/tex" id="MathJax-Element-408">y^*_{r+1}</script> into the expression for <script type="math/tex" id="MathJax-Element-409">y_{r+1}</script> we achieve</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-410">y_{r+1} = y_r + \frac h 2 [f(x_r, y_r) + f(x_{r+1}, y_r + hf(x_r, y_r))]</script></p>

<p>Noting that <script type="math/tex" id="MathJax-Element-411">x_{r+1} = x_r +h </script> this can be expressed as</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-412">y_{r+1} = y_r + \frac 1 2(k_1 + k_2)</script></p>

<p>where <script type="math/tex" id="MathJax-Element-413">k_1 = hf(x_r, y_r)</script> <br>
and <script type="math/tex" id="MathJax-Element-414">k_2 = hf(x_r + h, y_r + k_1)</script></p>



<h3 id="example-7">Example</h3>

<blockquote>
  <p>The function <script type="math/tex" id="MathJax-Element-415">y(x)</script> satisfies the differential equation <script type="math/tex" id="MathJax-Element-416">\frac{dy}{dx} = f(x, y)</script> where <script type="math/tex" id="MathJax-Element-417">f(x, y) = 2x^3 + 3 -2y, \quad x \geq 0</script>.  <br>
  The boundary condition is <script type="math/tex" id="MathJax-Element-418">y(0) = 5</script> </p>
  
  <p>a) Use the improved Euler method, with <script type="math/tex" id="MathJax-Element-419">h = 0.25</script>, to calculate approximations to the values of <script type="math/tex" id="MathJax-Element-420">y(0.25)</script> and <script type="math/tex" id="MathJax-Element-421">y(0.5)</script>. </p>
  
  <p>Setting out the solution in a tabular form</p>
  
  <table>
<thead>
<tr>
  <th><script type="math/tex" id="MathJax-Element-422">r</script></th>
  <th><script type="math/tex" id="MathJax-Element-423">x_r</script></th>
  <th><script type="math/tex" id="MathJax-Element-424">y_r</script></th>
  <th><script type="math/tex" id="MathJax-Element-425">k_1</script></th>
  <th><script type="math/tex" id="MathJax-Element-426">x_r + h</script></th>
  <th><script type="math/tex" id="MathJax-Element-427">y_r + k_1</script></th>
  <th><script type="math/tex" id="MathJax-Element-428">k_2</script></th>
  <th><script type="math/tex" id="MathJax-Element-429">y_{r+1}</script></th>
</tr>
</thead>
<tbody><tr>
  <td><script type="math/tex" id="MathJax-Element-430">0</script></td>
  <td><script type="math/tex" id="MathJax-Element-431">0</script></td>
  <td><script type="math/tex" id="MathJax-Element-432">5</script></td>
  <td><script type="math/tex" id="MathJax-Element-433">-1.75</script></td>
  <td><script type="math/tex" id="MathJax-Element-434">0.25</script></td>
  <td><script type="math/tex" id="MathJax-Element-435">3.25</script></td>
  <td><script type="math/tex" id="MathJax-Element-436">-0.84375</script></td>
  <td><script type="math/tex" id="MathJax-Element-437">3.70125</script></td>
</tr>
<tr>
  <td><script type="math/tex" id="MathJax-Element-438">1</script></td>
  <td><script type="math/tex" id="MathJax-Element-439">0.25</script></td>
  <td><script type="math/tex" id="MathJax-Element-440">3.703125</script></td>
  <td><script type="math/tex" id="MathJax-Element-441">-1.0703125</script></td>
  <td><script type="math/tex" id="MathJax-Element-442">0.5</script></td>
  <td><script type="math/tex" id="MathJax-Element-443">2.638125</script></td>
  <td><script type="math/tex" id="MathJax-Element-444">-0.44140625</script></td>
  <td><script type="math/tex" id="MathJax-Element-445">2.947266</script></td>
</tr>
</tbody></table>

  
  <p>b) The exact solution to the differential equation is <script type="math/tex" id="MathJax-Element-446">y(x) = 3e^{-2x} + x^2 -x + 2</script>. <br>
  Calculate, to two significant figures, the percentage error in the value of <script type="math/tex" id="MathJax-Element-447">y(0.5)</script> obtained in part (a).</p>
  
  <p><script type="math/tex" id="MathJax-Element-448">y(0.5) = 3e^{-1} + 0.5^2 - 0.5 + 2 \approx 2.853638</script>  <br>
   Hence the error is  <br>
   <script type="math/tex" id="MathJax-Element-449">\dfrac{2.942766 - 2.853638}{2.853638} \times 100\% \approx 3.3 \%</script></p>
</blockquote>

<h2 id="error-analysis">Error analysis</h2>

<p>The three numerical formulae were derived by geometrical considerations.  <br>
They can also be derived analytically.</p>

<p>The Maclaurin series for <script type="math/tex" id="MathJax-Element-452">y(h)</script> is</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-490">y(h) = y(0) + hy'(0) + \frac{h^2}{2!}y''(0) + \frac{h^3}{3!}y'''(0) +\ ...,</script></p>

<p>If the origin is transferred to the point <script type="math/tex" id="MathJax-Element-491">x_r</script>, this becomes</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-521">y(x_r + h) = y(x_r) + hy'(x_r) + \frac{h^2}{2!}y''(x_r) + \frac{h^3}{3!}y'''(x_r) +\ ...,</script></p>

<p>which is Taylor’s series.</p>

<p>Noting that <script type="math/tex" id="MathJax-Element-522">y'(x_r) = f(x_r, y_r)</script>, the Taylor series may be expressed as</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-760">y_{r+1} = y_r + hf(x_r, y_r) + \frac{h^2}{2!}y''(x_r) + \frac{h^3}{3!}y'''(x_r) +\ ..., </script></p>

<p>If <script type="math/tex" id="MathJax-Element-761">h</script> is assumed to be sufficiently small for terms in <script type="math/tex" id="MathJax-Element-762">h^2,\ h^3,\ ...</script> to be negligible, then the series reduces to </p>

<p><script type="math/tex" id="MathJax-Element-763">y_{r+1} = y_r + hf(x_r, y_r)</script></p>

<p>which is Euler’s formula.</p>

<p>Taylor’s series can also be used to step backwards from <script type="math/tex" id="MathJax-Element-764">x_r</script> to <script type="math/tex" id="MathJax-Element-765">x_{r-1}</script>, <script type="math/tex" id="MathJax-Element-766">(r \geq 1)</script>, by replacing <script type="math/tex" id="MathJax-Element-767">h</script> with <script type="math/tex" id="MathJax-Element-768">-h</script>.</p>

<p>This gives</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-812">y_{r-1} = y_r -hf(x_r, y_r) + \frac{h^2}{2!}y''(x_r) - \frac{h^3}{3!}y'''(x_r)+\ ..., </script> </p>

<p>Subtracting this from the series for <script type="math/tex" id="MathJax-Element-813">y_{r+1}</script> and neglecting all terms in $h^3£ and higher powers gives</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-842">y_{r+1} = y_{r-1} + 2hf(x_r, y_r), \quad (r \geq 1)</script></p>

<p>which is the mid-point formula.</p>

<p>Finally, to obtain the improved Euler formula, first replace <script type="math/tex" id="MathJax-Element-843">y</script> by <script type="math/tex" id="MathJax-Element-844">y'</script> in the Taylor series, giving</p>



<p><script type="math/tex; mode=display" id="MathJax-Element-845"></script></p></div></body>
</html>